<mvc:View 
    controllerName="management.controller.Ticket" 
    xmlns:mvc="sap.ui.core.mvc" 
    xmlns="sap.m" 
    xmlns:semantic="sap.f.semantic" 
    displayBlock="true">

    <semantic:SemanticPage 
        id="page" 
        headerExpanded="true" 
        headerPinnable="false"
        titleAreaShrinkRatio="1:1.6:1.6">
        
        <semantic:titleHeading>
			<Title id="_IDGenTitle1" text="Tickets" />
		</semantic:titleHeading>

        <!-- IconTabBar pour les filtres -->
        <semantic:headerContent>
            <IconTabBar 
                id="iconTabBar" 
                select="onQuickFilter"> <!-- EventHandler pour le filtrage -->
                <items>
                    <IconTabFilter id="_IDGenIconTabFilter1" 
                        key="all" 
                        text="Tickets" 
                        showAll="true"
                        class="filterbuttonsuccess"
                        count="{CountModel>/count}"/>  <!-- Afficher tous les tickets -->
                    <IconTabFilter id="_IDGenIconTabFilter2" key="completed" text="Done" 
                        icon="sap-icon://message-success"
						iconColor="Positive"
                        class="sapUiIconSuccess"
                        count="{CountModel>/completed}" 
                        /> <!-- Tickets terminés -->
                    <IconTabFilter id="_IDGenIconTabFilter3" key="in_progress" text="In Progress" 
                        icon="sap-icon://message-warning"
						iconColor="Critical"
                        class="sapUiIconCritical"
                        count="{CountModel>/in_progress}"/> <!-- Tickets en cours -->
                    <IconTabFilter id="_IDGenIconTabFilter4" key="not_assigned" text="Unassigned"
                        icon="sap-icon://message-error"
						iconColor="Negative" 
                        class="sapUiIconDanger"
                        count="{CountModel>/not_assigned}"/>
                        
                     <IconTabFilter id="_IDGenIconTabFilter5"  
                        key="create" 
                        text="Create" 
                        icon="sap-icon://add" />

                </items>
            </IconTabBar>

        </semantic:headerContent>

        
        <!-- Contenu principal avec la table des tickets -->
        <semantic:content>
            <Table 
                id="idProductsTable" 
                inset="false" 
                items="{ path: '/TICKETIDSet' }"> <!-- Liaison aux données OData -->

                <columns>
                    <!-- Définition des colonnes -->
                    <Column id="_IDGenColumn1" width="12em"><Text id="_IDGenText1" text="Id Ticket" /></Column>
                    <Column id="_IDGenColumn2" width="5em"><Text id="_IDGenText2" text="Ticket Jira" /></Column>
                    <Column id="_IDGenColumn3" width="7em"><Text id="_IDGenText3" text="Consultant" /></Column>
                    <Column id="_IDGenColumn4" width="7em"><Text id="_IDGenText4" text="Titre" /></Column>
                    <Column id="_IDGenColumn5" width="20em"><Text id="_IDGenText5" text="Projet" /></Column>
                    <Column id="_IDGenColumn6"><Text id="_IDGenText6" text="Status" /></Column>
                    <Column id="_IDGenColumn7"><Text id="_IDGenText7" text="Start Date" /></Column>
                    <Column id="_IDGenColumn8"><Text id="_IDGenText8" text="Assign" /></Column>
                </columns>

                <!-- Contenu des items de la table -->
                <items>
                    <ColumnListItem id="_IDGenColumnListItem1">
                        <cells>
                            <ObjectIdentifier id="_IDGenObjectIdentifier1" text="{IdTicket}" />
                            <Text id="_IDGenText9" text="{IdJira}" />
                            <Text id="_IDGenText10" text="{Consultant}" />
                            <Text id="_IDGenText11" text="{Titre}" />
                            <Text id="_IDGenText12" text="{Projet}" />
                            <Text id="_IDGenText13" text="{Status}" />
                            <Text id="_IDGenText14" text="{CreationDate}" />
                            <ToggleButton id="_IDGenToggleButton1" 
                                icon="sap-icon://add-document" 
                                type="Emphasized"
                                enabled="{= ${Status} === 'NON-AFFECTER' }" 
                                press="onAssignTicket" /> <!-- Appel de la fonction d'assignation -->
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>
        </semantic:content>

    </semantic:SemanticPage>
    
</mvc:View>
